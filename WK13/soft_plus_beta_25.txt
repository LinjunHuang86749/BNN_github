def objective(trial):
  tudui = TUdui().to(device)
  tudui.load_state_dict(torch.load("model_pretrained_layer_3_size_32_ini_n_0_2_new_softplus_25.pth"))

  params = {
      "num_inner_loop": 100,
      "n": 100,
      "A1": trial.suggest_float("A1", 1, 10),
      "B1": trial.suggest_float("B1", 10, 100, log=True),
      "A2": trial.suggest_float("A2", 10, 40), 
      "B2": trial.suggest_float("B2", 1e-2, 10, log=True), 
      "tudui": tudui
  }

  score = get_model_loss(params)
  return score

sampler = optuna.samplers.TPESampler(seed=511)
study = optuna.create_study(direction="minimize", sampler=sampler)
study.optimize(objective, n_trials=100, timeout=None, n_jobs = 1)

study.best_params

[I 2022-09-23 21:19:45,904] A new study created in memory with name: no-name-0495794d-8f86-47cf-8368-f2446358b642
[I 2022-09-23 21:43:57,171] Trial 0 finished with value: 0.2985224723815918 and parameters: {'A1': 3.4242622880004387, 'B1': 64.51958348791871, 'A2': 17.149295081210823, 'B2': 1.1811846157813501}. Best is trial 0 with value: 0.2985224723815918.
[I 2022-09-23 21:51:00,876] Trial 1 finished with value: 2.2492306232452393 and parameters: {'A1': 6.075818184166681, 'B1': 51.85871474065287, 'A2': 12.711269389059817, 'B2': 0.09517460233806578}. Best is trial 0 with value: 0.2985224723815918.
[I 2022-09-23 22:00:22,336] Trial 2 finished with value: 0.33194029331207275 and parameters: {'A1': 9.83614135075622, 'B1': 42.12408790565632, 'A2': 36.52721373917157, 'B2': 0.1828981249264376}. Best is trial 0 with value: 0.2985224723815918.
[I 2022-09-23 22:07:34,662] Trial 3 finished with value: 0.5619542002677917 and parameters: {'A1': 6.493241719514662, 'B1': 16.64504148971496, 'A2': 22.042210946597095, 'B2': 0.10785982625903934}. Best is trial 0 with value: 0.2985224723815918.
[I 2022-09-23 22:12:27,836] Trial 4 finished with value: 0.5314755439758301 and parameters: {'A1': 9.899707298452494, 'B1': 10.781288139387106, 'A2': 34.45266847375616, 'B2': 0.6252532594538873}. Best is trial 0 with value: 0.2985224723815918.
[I 2022-09-23 22:36:35,253] Trial 5 finished with value: 0.41128116846084595 and parameters: {'A1': 2.009028276992422, 'B1': 68.74785424044136, 'A2': 10.01222530356572, 'B2': 0.010704557991364482}. Best is trial 0 with value: 0.2985224723815918.
[I 2022-09-23 22:48:20,083] Trial 6 finished with value: 0.38394004106521606 and parameters: {'A1': 5.57466624513341, 'B1': 25.597018295604663, 'A2': 23.442395957288213, 'B2': 0.45248277667737974}. Best is trial 0 with value: 0.2985224723815918.
[I 2022-09-23 23:07:10,844] Trial 7 finished with value: 0.4799647629261017 and parameters: {'A1': 6.428545926046752, 'B1': 33.23710308039665, 'A2': 11.157269162905607, 'B2': 3.8209465432877225}. Best is trial 0 with value: 0.2985224723815918.
[I 2022-09-23 23:16:34,187] Trial 8 finished with value: 1.9473124742507935 and parameters: {'A1': 5.471065027657823, 'B1': 12.04729052007231, 'A2': 10.526400837036261, 'B2': 0.029176113932055204}. Best is trial 0 with value: 0.2985224723815918.
[I 2022-09-23 23:30:50,503] Trial 9 finished with value: 0.2964490056037903 and parameters: {'A1': 4.013177749232257, 'B1': 18.67011266728186, 'A2': 25.1865841923698, 'B2': 0.684419882984157}. Best is trial 9 with value: 0.2964490056037903.
[I 2022-09-23 23:54:24,257] Trial 10 finished with value: 0.29328444600105286 and parameters: {'A1': 1.17095836409597, 'B1': 20.070475320143775, 'A2': 31.21867936581681, 'B2': 5.142038410778088}. Best is trial 10 with value: 0.29328444600105286.
[I 2022-09-24 00:17:45,198] Trial 11 finished with value: 0.30438369512557983 and parameters: {'A1': 1.0893421719361718, 'B1': 20.48341619112536, 'A2': 30.0783074418984, 'B2': 8.78234955949247}. Best is trial 10 with value: 0.29328444600105286.
[I 2022-09-24 00:31:36,542] Trial 12 finished with value: 0.2911384403705597 and parameters: {'A1': 3.4986104680070693, 'B1': 18.7846996460751, 'A2': 29.078024672326684, 'B2': 2.0868528320546273}. Best is trial 12 with value: 0.2911384403705597.
[I 2022-09-24 00:52:28,826] Trial 13 finished with value: 0.2506631910800934 and parameters: {'A1': 2.7015162619958595, 'B1': 28.846083738740997, 'A2': 30.260473132652056, 'B2': 2.667396215816403}. Best is trial 13 with value: 0.2506631910800934.
[I 2022-09-24 01:13:55,330] Trial 14 finished with value: 0.2374354600906372 and parameters: {'A1': 3.1180808321264886, 'B1': 31.04993526874729, 'A2': 39.35055375833342, 'B2': 1.5511159968770203}. Best is trial 14 with value: 0.2374354600906372.
[I 2022-09-24 01:37:43,557] Trial 15 finished with value: 0.3141377866268158 and parameters: {'A1': 2.5347127337007267, 'B1': 98.42328185633501, 'A2': 37.93213702007359, 'B2': 2.199789772475292}. Best is trial 14 with value: 0.2374354600906372.
[I 2022-09-24 01:51:54,752] Trial 16 finished with value: 0.28020232915878296 and parameters: {'A1': 4.47610417211107, 'B1': 33.459969657812564, 'A2': 33.51117397641829, 'B2': 1.3602704916416148}. Best is trial 14 with value: 0.2374354600906372.
[I 2022-09-24 02:01:14,642] Trial 17 finished with value: 0.32135704159736633 and parameters: {'A1': 7.8901194248394555, 'B1': 27.760950728227016, 'A2': 39.80893353992512, 'B2': 9.226737137630446}. Best is trial 14 with value: 0.2374354600906372.
[I 2022-09-24 02:24:52,353] Trial 18 finished with value: 0.26379767060279846 and parameters: {'A1': 2.6978382916198456, 'B1': 41.33328798499747, 'A2': 27.887703666413472, 'B2': 3.272366662673927}. Best is trial 14 with value: 0.2374354600906372.
[I 2022-09-24 02:41:18,249] Trial 19 finished with value: 0.31979358196258545 and parameters: {'A1': 4.750240265844387, 'B1': 25.45413045516556, 'A2': 19.261579128664067, 'B2': 0.20300236732466473}. Best is trial 14 with value: 0.2374354600906372.
[I 2022-09-24 03:02:21,880] Trial 20 finished with value: 0.2462364286184311 and parameters: {'A1': 1.9032111500838993, 'B1': 14.218431481933928, 'A2': 33.72715250452045, 'B2': 0.9783492527650667}. Best is trial 14 with value: 0.2374354600906372.
[I 2022-09-24 03:24:21,855] Trial 21 finished with value: 0.2428354024887085 and parameters: {'A1': 1.9628909872377531, 'B1': 12.340155989752024, 'A2': 33.04956562646681, 'B2': 1.1661013521981851}. Best is trial 14 with value: 0.2374354600906372.
[I 2022-09-24 03:45:23,574] Trial 22 finished with value: 0.24873730540275574 and parameters: {'A1': 1.765358891391295, 'B1': 13.856066608609474, 'A2': 34.61472120703571, 'B2': 1.1327975619868176}. Best is trial 14 with value: 0.2374354600906372.
[I 2022-09-24 04:06:31,534] Trial 23 finished with value: 0.2430034875869751 and parameters: {'A1': 1.9303181529208955, 'B1': 14.106053120113106, 'A2': 39.42003236779941, 'B2': 0.4021603238460829}. Best is trial 14 with value: 0.2374354600906372.
[I 2022-09-24 04:15:52,488] Trial 24 finished with value: 0.33220353722572327 and parameters: {'A1': 3.390584152113393, 'B1': 10.299949237122899, 'A2': 38.901537068287105, 'B2': 0.32839903809960785}. Best is trial 14 with value: 0.2374354600906372.
[I 2022-09-24 04:32:19,667] Trial 25 finished with value: 0.27072277665138245 and parameters: {'A1': 2.425618380623876, 'B1': 14.510391959279312, 'A2': 36.6434369015466, 'B2': 0.47234560230955774}. Best is trial 14 with value: 0.2374354600906372.
[I 2022-09-24 04:55:37,272] Trial 26 finished with value: 0.2657509446144104 and parameters: {'A1': 1.4439415829754774, 'B1': 16.107898558588204, 'A2': 39.85938850083677, 'B2': 0.22448138655605054}. Best is trial 14 with value: 0.2374354600906372.
[I 2022-09-24 05:04:58,180] Trial 27 finished with value: 0.3372672200202942 and parameters: {'A1': 3.8254977620153037, 'B1': 12.294408077267704, 'A2': 36.31142210653796, 'B2': 0.07104084245380174}. Best is trial 14 with value: 0.2374354600906372.